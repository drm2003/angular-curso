{"ast":null,"code":"import { EmailService } from '../../email.service';\nimport { PageDataService } from '../../services/page-data.service';\nimport { HeaderDataService } from '../../services/header.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../email.service\";\nimport * as i2 from \"../../services/page-data.service\";\nimport * as i3 from \"../../services/header.service\";\nimport * as i4 from \"../../components/header/header.component\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"../../components/footer/footer.component\";\n\nfunction CaixaDeEntradaComponent_section_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 30);\n    i0.ɵɵelementStart(1, \"p\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.mensagemErro, \" \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"newEmail--active\": a0\n  };\n};\n\nconst _c1 = function (a0) {\n  return {\n    \"is-invalid\": a0\n  };\n};\n\nexport let CaixaDeEntradaComponent = /*#__PURE__*/(() => {\n  class CaixaDeEntradaComponent {\n    constructor(emailService, pageService, headerService) {\n      this.emailService = emailService;\n      this.pageService = pageService;\n      this.headerService = headerService;\n      this._isNewEmailFormOpen = false;\n      this.emailList = [];\n      this.termoParaFiltro = '';\n      this.email = {\n        destinatario: '',\n        assunto: '',\n        conteudo: '',\n        dataDeEnvio: ''\n      };\n    }\n\n    ngOnInit() {\n      this.emailService.listar().subscribe({\n        next: lista => {\n          this.emailList = lista;\n        },\n        error: responseError => {\n          this.mensagemErro = responseError.message;\n        }\n      });\n      this.pageService.defineTitulo('Caixa de entrada - CMail');\n      this.headerService.valorDoFiltro.subscribe(novoValor => this.termoParaFiltro = novoValor);\n    }\n\n    get isNewEmailFormOpen() {\n      return this._isNewEmailFormOpen;\n    }\n\n    toggleIsNewEmailForm() {\n      this._isNewEmailFormOpen = !this._isNewEmailFormOpen;\n    }\n\n    handleNewEmail(formEmail) {\n      if (formEmail.invalid) {\n        return;\n      }\n\n      this.emailService.enviar(this.email).subscribe({\n        next: emailApi => {\n          //fazemos todas as outras operações após o OK da API\n          this.emailList.push(emailApi);\n          this.email = {\n            destinatario: '',\n            assunto: '',\n            conteudo: '',\n            dataDeEnvio: ''\n          };\n        },\n        error: erro => {\n          console.error(erro);\n        }\n      });\n      formEmail.reset();\n    }\n    /*  handleNewEmail(formEmail: NgForm) {\n       if (formEmail.invalid) {\n         return;\n       }\n           this.emailList.push(this.email);\n           this.email = {\n         destinatario: '',\n         assunto: '',\n         conteudo: ''\n       }\n           formEmail.reset();\n     } */\n\n\n    handleRemoveEmail(eventoVaiRemover, emailId) {\n      console.log(eventoVaiRemover);\n\n      if (eventoVaiRemover.status === 'removing') {\n        //o próximo passo é agar da API!\n        this.emailService.deletar(emailId).subscribe(res => {\n          console.log(res);\n          this.emailList = this.emailList.filter(email => email.id != emailId);\n        }, err => console.log(err));\n      }\n    }\n\n    filtrarEmailsPorAssunto() {\n      const termoParaFiltroEmMinusculo = this.termoParaFiltro.toLocaleLowerCase();\n      return this.emailList.filter(email => {\n        const assunto = email.assunto.toLowerCase();\n        return assunto.includes(termoParaFiltroEmMinusculo);\n      });\n    }\n\n  }\n\n  CaixaDeEntradaComponent.ɵfac = function CaixaDeEntradaComponent_Factory(t) {\n    return new (t || CaixaDeEntradaComponent)(i0.ɵɵdirectiveInject(i1.EmailService), i0.ɵɵdirectiveInject(i2.PageDataService), i0.ɵɵdirectiveInject(i3.HeaderDataService));\n  };\n\n  CaixaDeEntradaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CaixaDeEntradaComponent,\n    selectors: [[\"app-caixa-de-entrada\"]],\n    decls: 51,\n    vars: 16,\n    consts: [[1, \"mdl-layout\", \"mdl-js-layout\", \"mdl-layout--fixed-drawer\", \"mdl-layout--fixed-header\"], [1, \"mdl-layout__content\"], [1, \"page-content\"], [1, \"mdl-grid\"], [\"class\", \"mdl-textfield is-invalid\", 4, \"ngIf\"], [\"role\", \"tooltip\", \"aria-label\", \"Criar novo email\", 1, \"globalFab\", \"tooltip\", \"btn\", \"mdl-button\", \"mdl-js-button\", \"mdl-button--fab\", \"mdl-button--colored\", 3, \"click\"], [1, \"material-icons\"], [\"action\", \"#\", 1, \"newEmail\", \"cmailForm\", 3, \"ngClass\", \"ngSubmit\"], [\"formEmail\", \"ngForm\"], [1, \"newEmail__card\", \"demo-card-wide\", \"mdl-card\", \"mdl-shadow--2dp\"], [1, \"newEmail__titleArea\", \"mdl-card__title\"], [1, \"newEmail__title\", \"mdl-card__title-text\"], [1, \"newEmail__body\", \"mdl-card__supporting-text\"], [1, \"cmailInputForm\"], [1, \"mdl-textfield\", \"mdl-textfield--floating-label\", 3, \"ngClass\"], [\"required\", \"\", \"type\", \"email\", \"name\", \"para\", \"id\", \"para\", \"placeholder\", \" \", 1, \"mdl-textfield__input\", 3, \"ngModel\", \"ngModelChange\"], [\"destinatario\", \"ngModel\"], [1, \"mdl-textfield__error\"], [\"for\", \"para\", 1, \"mdl-textfield__label\"], [1, \"mdl-textfield__formline\"], [\"required\", \"\", \"type\", \"text\", \"name\", \"assunto\", \"id\", \"assunto\", \"placeholder\", \" \", 1, \"mdl-textfield__input\", 3, \"ngModel\", \"ngModelChange\"], [\"assunto\", \"ngModel\"], [\"for\", \"assunto\", 1, \"mdl-textfield__label\"], [\"name\", \"conteudo\", \"id\", \"conteudo\", \"placeholder\", \" \", 1, \"mdl-textfield__input\", 3, \"ngModel\", \"ngModelChange\"], [\"conteudo\", \"ngModel\"], [\"for\", \"conteudo\", 1, \"mdl-textfield__label\"], [1, \"mdl-card__actions\", \"mdl-card--border\"], [1, \"mdl-button\", \"mdl-js-button\", \"mdl-button--raised\", \"mdl-button--colored\"], [1, \"newEmail__topMenu\", \"mdl-card__menu\"], [\"type\", \"button\", 1, \"mdl-button\", \"mdl-button--icon\", 3, \"click\"], [1, \"mdl-textfield\", \"is-invalid\"]],\n    template: function CaixaDeEntradaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r5 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"cmail-header\");\n        i0.ɵɵelementStart(2, \"main\", 1);\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵelementStart(4, \"div\", 3);\n        i0.ɵɵtemplate(5, CaixaDeEntradaComponent_section_5_Template, 3, 1, \"section\", 4);\n        i0.ɵɵelementStart(6, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function CaixaDeEntradaComponent_Template_button_click_6_listener() {\n          return ctx.toggleIsNewEmailForm();\n        });\n        i0.ɵɵelementStart(7, \"span\", 6);\n        i0.ɵɵtext(8, \"add\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"form\", 7, 8);\n        i0.ɵɵlistener(\"ngSubmit\", function CaixaDeEntradaComponent_Template_form_ngSubmit_9_listener() {\n          i0.ɵɵrestoreView(_r5);\n\n          const _r1 = i0.ɵɵreference(10);\n\n          return ctx.handleNewEmail(_r1);\n        });\n        i0.ɵɵelementStart(11, \"div\", 9);\n        i0.ɵɵelementStart(12, \"div\", 10);\n        i0.ɵɵelementStart(13, \"h2\", 11);\n        i0.ɵɵtext(14, \"Novo Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 12);\n        i0.ɵɵelementStart(16, \"div\", 13);\n        i0.ɵɵelementStart(17, \"div\", 14);\n        i0.ɵɵelementStart(18, \"input\", 15, 16);\n        i0.ɵɵlistener(\"ngModelChange\", function CaixaDeEntradaComponent_Template_input_ngModelChange_18_listener($event) {\n          return ctx.email.destinatario = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"span\", 17);\n        i0.ɵɵtext(21, \"Informar um email \\u00E9 obrigat\\u00F3rio!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"label\", 18);\n        i0.ɵɵtext(23, \"Para: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"span\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 13);\n        i0.ɵɵelementStart(26, \"div\", 14);\n        i0.ɵɵelementStart(27, \"input\", 20, 21);\n        i0.ɵɵlistener(\"ngModelChange\", function CaixaDeEntradaComponent_Template_input_ngModelChange_27_listener($event) {\n          return ctx.email.assunto = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"span\", 17);\n        i0.ɵɵtext(30, \"Informar um assunto \\u00E9 obrigat\\u00F3rio!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"label\", 22);\n        i0.ɵɵtext(32, \"Assunto: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(33, \"span\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"div\", 13);\n        i0.ɵɵelementStart(35, \"div\", 14);\n        i0.ɵɵelementStart(36, \"textarea\", 23, 24);\n        i0.ɵɵlistener(\"ngModelChange\", function CaixaDeEntradaComponent_Template_textarea_ngModelChange_36_listener($event) {\n          return ctx.email.conteudo = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"span\", 17);\n        i0.ɵɵtext(39, \"Informar um conte\\u00FAdo \\u00E9 obrigat\\u00F3rio!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"label\", 25);\n        i0.ɵɵtext(41, \"Conte\\u00FAdo: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(42, \"span\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"div\", 26);\n        i0.ɵɵelementStart(44, \"button\", 27);\n        i0.ɵɵtext(45, \" Enviar \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"div\", 28);\n        i0.ɵɵelementStart(47, \"button\", 29);\n        i0.ɵɵlistener(\"click\", function CaixaDeEntradaComponent_Template_button_click_47_listener() {\n          return ctx.toggleIsNewEmailForm();\n        });\n        i0.ɵɵelementStart(48, \"span\", 6);\n        i0.ɵɵtext(49, \"close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(50, \"cmail-footer\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(19);\n\n        const _r3 = i0.ɵɵreference(28);\n\n        const _r4 = i0.ɵɵreference(37);\n\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.mensagemErro);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c0, ctx.isNewEmailFormOpen));\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c1, _r2.invalid && _r2.touched));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.email.destinatario);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(12, _c1, _r3.invalid && _r3.touched));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.email.assunto);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(14, _c1, _r4.invalid && _r4.touched));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.email.conteudo);\n      }\n    },\n    directives: [i4.HeaderComponent, i5.NgIf, i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.NgForm, i5.NgClass, i6.DefaultValueAccessor, i6.RequiredValidator, i6.NgControlStatus, i6.NgModel, i7.FooterComponent],\n    styles: [\"\", \"ul[_ngcontent-%COMP%], li[_ngcontent-%COMP%]{margin:0;padding:0;list-style-type:none}\"]\n  });\n  return CaixaDeEntradaComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}